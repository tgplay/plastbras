/*!
 
 (c) 2022 impleCode - https://implecode.com
 */
function ic_register_block(Te,e,r){const Re=window.wp.blocks;const t=window.wp.blockEditor;const a=window.wp.element;const l=window.wp.components;const Qe=window.wp.serverSideRender;const Fe=window.wp.htmlEntities.decodeEntities;var Le=a.createElement;var Me=t.InspectorControls;var De=l.SelectControl;var ze=l.TextControl;var Ue=l.RadioControl;var qe=l.Spinner;var Ge=l.Notice;var He=l.ToggleControl;var Je=l.CheckboxControl;var Ke=l.SearchControl;var Ve=t.MediaPlaceholder;var We=l.Panel;var Xe=l.PanelBody;var Ye=l.PanelRow;var Ze=t.AlignmentToolbar;var $e=l.ToolbarButton;var et=t.BlockControls;var tt=t.useBlockProps;var rt=a.useState;var at=[];var lt=Te.split("/");lt=lt[1];var s={};if(r!==undefined){s.from=[{type:"block",blocks:["core/legacy-widget"],isMatch:({idBase:e,instance:t})=>{if(t.raw===undefined){return false}return e===r},transform:({instance:e})=>{return Re.createBlock(Te,e.raw)}}]}Re.registerBlockType(Te,{transforms:s,usesContext:e,edit:function(s){const o=s.attributes;const e=Re.getBlockSupport(Te,"ic_fields");const[i,n]=rt(false);function t(e){s.setAttributes({title:e})}function r(e){s.setAttributes({shortcode_support:e})}function a(e){s.setAttributes({dropdown:e})}function l(e){s.setAttributes({count:e})}function c(e){s.setAttributes({hierarchical:e})}function d(e,t,r){if(Array.isArray(o.selectedCategory)){if(t!==undefined){var a=false;var l=it(o);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedCategory:l})}if(o.category.length){s.setAttributes({category:[]})}if(l.length&&o.selectedProduct!==undefined&&o.selectedProduct.length){s.setAttributes({selectedProduct:[]})}}else{s.setAttributes({category:e})}}else{s.setAttributes({category:e})}}function u(e){s.setAttributes({orderby:e})}function p(e){s.setAttributes({order:e})}function f(e){s.setAttributes({archive_template:e})}function g(e){s.setAttributes({per_row:e})}function b(e){s.setAttributes({no_add_to_cart:e})}function h(e,t,r){if(Array.isArray(o.selectedProduct)){if(t!==undefined){var a=false;var l=ot(o);l=l.filter(function(e){if(typeof e==="object"){if(e.value===t){a=true}return e.value!==t}else{if(e===t){a=true}return e!==t}});if(e){a=true;l.push({value:t,label:r})}if(a){s.setAttributes({selectedProduct:l})}if(o.product!==undefined&&o.product.length){s.setAttributes({product:[]})}if(l.length&&o.selectedCategory!==undefined&&o.selectedCategory.length){s.setAttributes({selectedCategory:[]})}}}else{s.setAttributes({selectedProduct:parseInt(e,10)});if(i){n(false)}}}function _(e){s.setAttributes({alignment:e===undefined?"none":e})}function y(e){s.setAttributes({productSearch:e===undefined?"":e})}function v(e){s.setAttributes({categorySearch:e===undefined?"":e})}function k(e){s.setAttributes({productFromContext:e});if(e){if(o.product!==undefined&&o.product.length){s.setAttributes({product:[]})}if(o.category!==undefined&&o.category.length){s.setAttributes({product:[]})}if(o.selectedCategory!==undefined&&o.selectedCategory.length){s.setAttributes({selectedCategory:[]})}if(o.selectedProduct!==undefined){if(Array.isArray(o.selectedProduct)&&o.selectedProduct.length){s.setAttributes({selectedProduct:[]})}else{s.setAttributes({selectedProduct:0})}}if(o.categorySearch!==undefined&&o.categorySearch.length){s.setAttributes({categorySearch:""})}if(o.productSearch!==undefined&&o.productSearch.length){s.setAttributes({productSearch:""})}}}function m(e,t){s.setAttributes({[e]:t})}function A(e){s.setAttributes({image_id:e.id?e.id:0});s.setAttributes({image_id_url:e.url?e.url:""})}var w=[];var j=[];var C=[];var x={};var I=false;var P=[];var S=st(o);s.attributes.ic_context_id=ic_blocks_js_global.context.id;s.attributes.ic_context_post_type=ic_blocks_js_global.context.type;var E=Le(Qe,{key:lt+"-server-side-renderer",block:Te,attributes:s.attributes});var N=E;if(o.title!==undefined){var O=o.title;j.push(Le(ze,{label:ic_blocks_js_global.strings.select_title,value:O,key:lt+"-title",type:"text",onChange:t}))}if(o.shortcode_support!==undefined){var B=o.shortcode_support;j.push(Le(Je,{label:ic_blocks_js_global.strings.select_shortcode_support,value:"1",key:lt+"-shortcode-support",checked:B,type:"checkbox",onChange:r}))}if(o.dropdown!==undefined){var T=false;if(o.dropdown){T=true}j.push(Le(Je,{label:ic_blocks_js_global.strings.select_dropdown,value:"1",key:lt+"-dropdown",checked:T,type:"checkbox",onChange:a}))}if(o.count!==undefined){var R=false;if(o.count){R=true}j.push(Le(Je,{label:ic_blocks_js_global.strings.select_count,value:"1",key:lt+"-count",checked:R,type:"checkbox",onChange:l}))}if(o.hierarchical!==undefined){var Q=false;if(o.hierarchical){Q=true}j.push(Le(Je,{label:ic_blocks_js_global.strings.select_hierarchical,value:"1",key:lt+"-hierarchical",checked:Q,type:"checkbox",onChange:c}))}if(o.category!==undefined||o.selectedCategory!==undefined){var F=it(o);var L=[];var M=S.categories;var D=S.selected_categories;var z=[];if(M){if(D){D.forEach(e=>{if(e.value!==undefined){z.push(parseInt(e.value,10));if(e.value!==0){L.push({value:parseInt(e.value,10),label:Fe(e.label)})}}else{z.push(parseInt(e.id,10));if(e.id!==0){L.push({value:parseInt(e.id,10),label:Fe(e.name)+" ("+e.count+")"})}}})}M.forEach(e=>{if(!z.includes(parseInt(e.id,10))){L.push({value:parseInt(e.id,10),label:Fe(e.name)+" ("+e.count+")"})}})}var U="";var q=[];var G=[];var H="";if(o.categorySearch!==undefined){H=o.categorySearch;q.push(Le(Ke,{label:ic_blocks_js_global.strings.search_category,value:H,type:"string",key:lt+"-search-category",placeholder:ic_blocks_js_global.strings.category_search_placeholder,onChange:v}));L.forEach(t=>{G.push(Le(Ye,{key:lt+"-checkbox-row-category-"+t.value},Le(Je,{label:t.label,checked:z.includes(t.value),value:t.value,key:lt+"-checkbox-category-"+t.value,onChange:function(e){d(e,t.value,t.label)}})))})}else{G.push(Le(Ye,{key:lt+"-category-select-panel-row"},Le(De,{multiple:"multiple",label:"",key:lt+"-category-select",value:F,options:L,onChange:d})))}if(L.length===0){if(S.ready){if(H){q.push(Le(Ge,{key:lt+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword."))}}else{G.push(Le(qe,{key:lt+"category-selector-loading"}))}}var J=Le(Xe,{title:ic_blocks_js_global.strings.select_categories,key:lt+"-category-select-panel-body",className:"ic-panel-body",initialOpen:F},G);if(G.length===0){J=""}C.push(J);var K=ic_blocks_js_global.strings.choose_categories;if(o.selectedProduct!==undefined){K=ic_blocks_js_global.strings.by_category}var V="ic-panel-body";if(!H&&(L.length<5||L.length===0)){V="ic-hidden-panel-body"}if(q.length){U=Le(Xe,{title:ic_blocks_js_global.strings.search_category,key:lt+"-search-category-panel-body",className:V,initialOpen:true},q)}var W=Le(We,{header:K,key:lt+"-main-panel"},U,J);if(F.length===0){if(P.length===0){I=true}}else{I=false}P.push(W)}if(o.orderby!==undefined){var X=o.orderby;var Y=ic_blocks_js_global.category_orderby_options;j.push(Le(De,{label:ic_blocks_js_global.strings.select_orderby,value:X,key:lt+"-select-orderby",type:"dropdown",options:Y,onChange:u}))}if(o.order!==undefined){var Z=o.order;var $=ic_blocks_js_global.order_options;j.push(Le(De,{label:ic_blocks_js_global.strings.select_order,value:Z,key:lt+"-select-order",type:"dropdown",options:$,onChange:p}))}if(o.archive_template!==undefined){var ee=o.archive_template;var te=ic_blocks_js_global.template_options;j.push(Le(De,{label:ic_blocks_js_global.strings.select_template,value:ee,key:lt+"-select-template",type:"dropdown",options:te,onChange:f}))}if(o.per_row!==undefined){var re=o.per_row;j.push(Le(ze,{label:ic_blocks_js_global.strings.select_perrow,value:re,key:lt+"-select-per-row",type:"number",onChange:g}))}if(o.no_add_to_cart!==undefined){var ae=o.no_add_to_cart;if(ic_blocks_js_global.price_add_cart_added==="1"){j.push(Le(Ye,{key:lt+"-panel-body-row-noaddcart"},Le(Je,{label:ic_blocks_js_global.strings.disable_add_cart,checked:ae,onChange:b})))}}if(e!==undefined){for(const[xe,Ie]of Object.entries(e)){if(o[xe]!==undefined){var le=typeof o[xe];if(le==="boolean"){j.push(Le(Ye,{key:lt+"-panel-body-row-"+xe},Le(Je,{label:Ie,checked:o[xe],onChange:function(e){m(xe,e)}})))}else if(le==="string"){j.push(Le(ze,{label:Ie,value:o[xe],key:lt+"-"+xe,type:"text",onChange:function(e){m(xe,e)}}))}}}}if(o.alignment!==undefined){var se=o.alignment;w.push(Le(Ze,{value:se,key:lt+"-alignment",onChange:_}));x.textAlign=se}if(o.productSearch!==undefined&&o.selectedProduct!==undefined){var oe=o.productSearch;var ie=ot(o);var ne=[];at=[];var ce=[];var de=[];if(Array.isArray(ie)&&ie.length!==0||!Array.isArray(ie)&&ie){ce=S.selected_products;if(ce){if(Array.isArray(ce)){ce.forEach(e=>{if(e.value!==undefined){de.push(parseInt(e.value,10));at.push({value:parseInt(e.value,10),label:Fe(e.label)})}else{de.push(parseInt(e.id,10));at.push({value:parseInt(e.id,10),label:Fe(e.title.rendered)})}})}else{de.push(parseInt(ce,10));at.push({value:parseInt(ce,10),label:"Loading..."})}}}ne=S.products;if(ne){ne.forEach(e=>{if(!de.includes(parseInt(e.id,10))){at.push({value:parseInt(e.id,10),label:Fe(e.title.rendered)})}})}var ue=[Le(Ye,{key:lt+"-panel-body-row-product-search"},Le(Ke,{label:ic_blocks_js_global.strings.search_product,value:oe,type:"string",key:lt+"-search-product",className:"ic-search-control",placeholder:ic_blocks_js_global.strings.search_placeholder,onChange:y}))];var pe=[];var fe=[];var ge=[];var be=[];var he=[];if(Array.isArray(ie)){at.forEach(t=>{ge.push(Le(Ye,{key:lt+"-checkbox-row-product-"+t.value},Le(Je,{label:t.label,checked:de.includes(t.value),value:t.value,key:lt+"-checkbox-product-"+t.value,onChange:function(e){h(e,t.value,t.label)}})))})}else{ge.push(Le(Ue,{label:"",selected:ie,key:lt+"-product",onChange:h,options:at}));if(o.productFromContext!==undefined){const Pe=o.productFromContext?ic_blocks_js_global.strings.context_enabled_help:ic_blocks_js_global.strings.context_disabled_help;const Se=Le(Xe,{title:"",key:lt+"select-context-product-panel-body",className:"ic-panel-body",initialOpen:true},Le(Ye,{key:lt+"-panel-body-row-product-search-notice"},Le(He,{label:ic_blocks_js_global.strings.get_product_from_context,checked:o.productFromContext,key:lt+"-product-from-context",help:Pe,onChange:k})));if(o.productFromContext){be.push(Se);he.push(Se)}else{pe.push(Se);fe.push(Se)}}}var _e=ic_blocks_js_global.strings.select_product;if(o.category!==undefined){_e=ic_blocks_js_global.strings.by_product}else{const Ee=Re.getBlockType(s.name);const Ne=Ee.title;_e=Ne+" - "+_e}var ye="ic-panel-body";var ve=0;if(ce){ve+=ce.length}if(ne){ve+=ne.length}if(!oe&&(ve<10||ve===0)){ye="ic-hidden-panel-body"}if(ne===null||ne.length===0){if(S.ready){if(oe){ue.push(Le(Ye,{key:lt+"-panel-body-row-product-search-notice"},Le(Ge,{key:lt+"product-selector-not-found",status:"error",isDismissible:false},"Nothing found. Please use a different keyword.")))}}else{ge.push(Le(qe,{key:lt+"product-selector-loading"}))}}pe.push(Le(Xe,{title:ic_blocks_js_global.strings.search_product,key:lt+"-search-products-panel-body",className:ye,initialOpen:true},ue));pe.push(Le(Xe,{title:ic_blocks_js_global.strings.select_product,key:lt+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},ge));if(be.length){pe=be}var ke=Le(We,{header:_e,key:lt+"-search-products-block-panel"},pe);fe.push(ue);fe.push(ge);if(he.length){fe=he}C.push(Le(Xe,{title:ic_blocks_js_global.strings.select_product,key:lt+"-side-search-products-panel-body",className:"ic-panel-body",initialOpen:false},fe));if(Array.isArray(ie)&&ie.length===0){if(P.length===0){I=true}}else{I=false}P.push(ke)}if(o.image_id!==undefined){var me=[];const Oe=window.wp.data.useSelect(e=>{const t=o.image_id&&e("core").getMedia(o.image_id);return t&&t.media_details.sizes.medium.source_url},[o.image_id]);const Be=!!Oe&&Le("img",{src:Oe});me.push(Le(Ve,{key:lt+"image-id-selector",accept:"image/*",allowedTypes:["image"],multiple:false,onSelect:A,handleUpload:true,mediaPreview:Be}));P.push(Le(Xe,{title:ic_blocks_js_global.strings.select_product,key:lt+"select-product-panel-body",className:"ic-panel-body",initialOpen:true},Le(Ye,{key:lt+"-panel-body-row-image_id"},me)))}if(P.length!==0){w.push(Le($e,{icon:"edit",key:lt+"-edit-button",title:ic_blocks_js_global.strings.edit_block,onClick:()=>n(!i),isActive:i||I}))}var Ae=[Le(et,{key:lt+"-controls"},w)];var we=[];if(j.length){we.push(Le(Xe,{title:ic_blocks_js_global.strings.options,key:lt+"-main-panel-body",className:"main-panel-body",initialOpen:true},j))}if(C.length){we.push(C)}if(we.length){Ae.push(Le(Me,{key:"ic-price-field-table-block-controls"},we))}if(i||I){N=P;I=true;if(!i){n(true)}}var je="ic-block-output";if(I){je+="-edit"}var Ce={key:lt+"-div",className:je};if(!i){Ce.style=x;if(P.length!==0&&w.length<=1){Ce.onClick=()=>n(true)}}Ae.push(Le("div",tt(Ce),N));return Ae},save:function(){return null}});function st(b){const e=window.wp.data.useSelect(e=>{const t=e("core");var r={};r.ready=true;if(b.selectedCategory!==undefined){var a=it(b);var l={per_page:-1,_fields:"id,name,count",orderby:"term_group"};if(b.categorySearch!==undefined){var s=b.categorySearch;l.per_page=10;if(s){l.search=s;l.per_page=-1}}if(a.length!==0){var o=true;var i={per_page:-1,_fields:"id,name,count",orderby:"include",include:a.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{o=false;return parseInt(e,10)}})};r.selected_categories=t.getEntityRecords("taxonomy","al_product-cat",i);if(r.selected_categories===null&&o){r.selected_categories=a}else{}if(r.selected_categories===null){r.ready=false}else if(r.selected_categories.length>=l.per_page&&l.per_page>0){l.per_page=l.per_page+r.selected_categories.length}}r.categories=t.getEntityRecords("taxonomy","al_product-cat",l);if(r.categories===null){r.ready=false}}if(b.productSearch!==undefined&&b.selectedProduct!==undefined){var n=ot(b);var c=b.productSearch;var d={per_page:10,_fields:"id,title"};if(Array.isArray(n)&&n.length!==0||!Array.isArray(n)&&n){var u=true;var p={per_page:-1,_fields:"id,title",orderby:"include",include:Array.isArray(n)?n.map(function(e){if(typeof e==="object"){return parseInt(e.value,10)}else{u=false;return parseInt(e,10)}}):n};r.selected_products=t.getEntityRecords("postType","al_product",p);if(r.selected_products===null&&u){r.selected_products=n}else{}if(r.selected_products===null){r.ready=false}else if(r.selected_products.length>=d.per_page){d.per_page=d.per_page+r.selected_products.length}}if(c){d.search=c;d.per_page=100}r.products=t.getEntityRecords("postType","al_product",d);if(r.products===null){r.ready=false}}if(!r.ready){for(const[f,g]of Object.entries(r)){r[f]=null}}return r});return e}function ot(e){var t=e.selectedProduct;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.product.length){t=e.product.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedProduct,10)}return t}function it(e){var t=e.selectedCategory;if(Array.isArray(t)){if(t.length){t=t.map(function(e){if(typeof e==="object"){return{value:parseInt(e.value,10),label:e.label}}else{return{value:parseInt(e,10),label:"Loading..."}}})}else if(e.category.length){t=e.category.map(function(e){return{value:parseInt(e,10),label:"Loading..."}})}}else{t=parseInt(e.selectedCategory,10)}return t}}jQuery(window).load(function(){jQuery(".ic-product-meta-field").each(function(){jQuery(this).on("change",function(){var e=jQuery(this).attr("name");var t={};t[e]=jQuery(this).val();wp.data.dispatch("core/editor").editPost({meta:t})})});wp.media.featuredImage.frame().on("select",function(){var e=wp.media.featuredImage.get();var t="_thumbnail_id";var r={};r[t]=e;wp.data.dispatch("core/editor").editPost({meta:r})});jQuery("#remove-post-thumbnail").on("click",function(){var e="_thumbnail_id";var t={};t[e]="";wp.data.dispatch("core/editor").editPost({meta:t})})});